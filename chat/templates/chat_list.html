{% extends "base_chat.html" %}
{% load static %}
{% block title %}Naik Chat{% endblock %}
{% block chat_content %}

<div style="margin-top: 80px;">

  <!-- Header -->
  <div style="
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    margin-bottom: 20px; 
    background-color: #121212; 
    padding: 14px 20px; 
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  ">
    <h2 style="color: #fff; font-size: 28px; margin: 0;">Messages</h2>

    <a href="{% url 'chat:create_conversation_page' %}" 
       style="
         background: #ffffff;
         color: #121212;
         border: none;
         padding: 10px 16px;
         border-radius: 8px;
         text-decoration: none;
         font-weight: 600;
         transition: background 0.3s, color 0.3s;
       "
       onmouseover="this.style.background='#ddd';"
       onmouseout="this.style.background='#fff';">
      + New Message
    </a>
  </div>

  <!-- Chat List -->
  <ul style="list-style: none; padding: 0; margin: 0;">
    {% for convo in conversations %}
      <li style="
        background: #fff;
        color: #111;
        border-radius: 10px;
        padding: 14px 18px;
        margin-bottom: 14px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        transition: transform 0.2s, box-shadow 0.2s;
      "
      onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.25)';"
      onmouseout="this.style.transform='none'; this.style.boxShadow='0 2px 6px rgba(0,0,0,0.15)';">
        
        <a href="{% url 'chat:conversation_view' convo.id %}" style="color: inherit; text-decoration: none; display:block;">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <div><strong style="font-size: 16px;">{{ convo.other.username }}</strong></div>
            {% if convo.unread_count %}
              <div style="
                background: #FF4D4D; 
                color: #fff; 
                padding: 6px 10px; 
                border-radius: 12px; 
                font-weight: 600;
                font-size: 13px;
              ">
                {{ convo.unread_count }}
              </div>
            {% endif %}
          </div>

          {% if convo.last_message %}
            <div style="color:#555; margin-top:6px; font-size:14px;">
              {% if convo.last_sender_is_me %}
                You: {{ convo.last_message|truncatechars:60 }}
              {% else %}
                {{ convo.last_sender_username }}: {{ convo.last_message|truncatechars:60 }}
              {% endif %}
            </div>
          {% endif %}
        </a>
      </li>
    {% empty %}
      <li style="color:#888; text-align:center; margin-top:30px;">Belum ada percakapan.</li>
    {% endfor %}
  </ul>

  <hr style="border-color:#ccc; margin: 20px 0;">
</div>

{% endblock %}
